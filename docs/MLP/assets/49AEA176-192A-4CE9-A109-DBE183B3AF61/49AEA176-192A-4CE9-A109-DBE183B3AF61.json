{"assets":{"A977EEAD22A0E889A4E656D0ACC3EF31":{"type":"texture","index":0,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/49AEA176-192A-4CE9-A109-DBE183B3AF61.pdf"},"width":1024,"height":768},"39DD5CE94635D3B6CEFB2E81D7840CE2":{"type":"texture","index":1,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/49AEA176-192A-4CE9-A109-DBE183B3AF61.pdf"},"width":1024,"height":768}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00049229876906403734,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"39DD5CE94635D3B6CEFB2E81D7840CE2"},{"animations":[{"timeOffset":0,"from":{"scalar":false},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.01,"to":{"scalar":true}}],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A977EEAD22A0E889A4E656D0ACC3EF31"}]}]},"effects":[],"duration":0.01,"type":"transition","attributes":{"direction":0},"name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"def mse(output, target):","targetRectangle":{"y":25.519215394717577,"x":623.25771603824057,"width":202.2890625,"height":19}},{"text":"    return 0.5*(output - target)**2","targetRectangle":{"y":44.519215394717577,"x":623.25771603824057,"width":295.0048828125,"height":19}},{"text":"  ","targetRectangle":{"y":63.519215394717577,"x":623.25771603824057,"width":16.857421875,"height":19}},{"text":"def grad_mse(output, target):  ","targetRectangle":{"y":82.519215394717577,"x":623.25771603824057,"width":261.2900390625,"height":19}},{"text":"    return (output - target)","targetRectangle":{"y":101.51921539471758,"x":623.25771603824057,"width":236.00390625,"height":19}},{"text":"  def fit(self, X, Y, epochs = 100, lr = 0.001):","targetRectangle":{"y":256.69989928228136,"x":499.67270336794468,"width":404.578125,"height":19}},{"text":"    for e in range(epochs):    ","targetRectangle":{"y":275.69989928228136,"x":499.67270336794468,"width":261.2900390625,"height":19}},{"text":"     for x, y in zip(X, Y): ","targetRectangle":{"y":294.69989928228136,"x":499.67270336794468,"width":236.00390625,"height":19}},{"text":"        # add batch dimension","targetRectangle":{"y":313.69989928228136,"x":499.67270336794468,"width":244.4326171875,"height":19}},{"text":"        x = x[None,:]        ","targetRectangle":{"y":332.69989928228136,"x":499.67270336794468,"width":244.4326171875,"height":19}},{"text":"        y_pred = self(x) ","targetRectangle":{"y":351.69989928228136,"x":499.67270336794468,"width":210.7177734375,"height":19}},{"text":"        # loss function","targetRectangle":{"y":370.69989928228136,"x":499.67270336794468,"width":193.8603515625,"height":19}},{"text":"        loss = self.loss(y_pred, y).mean()","targetRectangle":{"y":389.69989928228136,"x":499.67270336794468,"width":354.005859375,"height":19}},{"text":"        # Backprop ","targetRectangle":{"y":408.69989928228136,"x":499.67270336794468,"width":160.1455078125,"height":19}},{"text":"        # dl\/dy","targetRectangle":{"y":427.69989928228136,"x":499.67270336794468,"width":126.4306640625,"height":19}},{"text":"        dldy = self.grad_loss(y_pred, y)        ","targetRectangle":{"y":446.69989928228136,"x":499.67270336794468,"width":404.578125,"height":19}},{"text":"        # dl\/dw2 = dl\/dy * dy\/dw2","targetRectangle":{"y":465.69989928228136,"x":499.67270336794468,"width":278.1474609375,"height":19}},{"text":"        grad_w2 = np.dot(self.h.T, dldy)","targetRectangle":{"y":484.69989928228136,"x":499.67270336794468,"width":337.1484375,"height":19}},{"text":"        grad_b2 = dldy.mean(axis=0)*self.h.shape[0]","targetRectangle":{"y":503.69989928228136,"x":499.67270336794468,"width":429.8642578125,"height":19.000000000000057}},{"text":"        # dl\/dh = dl\/dy * dy\/dh","targetRectangle":{"y":522.69989928228142,"x":499.67270336794468,"width":261.2900390625,"height":19}},{"text":"        dldh = np.dot(dldy, self.w2.T)*self.h      ","targetRectangle":{"y":541.69989928228142,"x":499.67270336794468,"width":429.8642578125,"height":19}},{"text":"        # dl\/dw1 = dl\/dy * dy\/dh * dh\/dw1","targetRectangle":{"y":560.69989928228142,"x":499.67270336794468,"width":345.5771484375,"height":19}},{"text":"        grad_w1 = np.dot(x.T, dldh)","targetRectangle":{"y":579.69989928228142,"x":499.67270336794468,"width":295.0048828125,"height":19}},{"text":"        grad_b1 = dldh.mean(axis=0)*x.shape[0]  ","targetRectangle":{"y":598.69989928228142,"x":499.67270336794468,"width":404.578125,"height":19}},{"text":"        # Update (GD)","targetRectangle":{"y":617.69989928228142,"x":499.67270336794468,"width":177.0029296875,"height":19}},{"text":"        self.w1 = self.w1 - lr * grad_w1","targetRectangle":{"y":636.69989928228142,"x":499.67270336794468,"width":337.1484375,"height":19}},{"text":"        self.b1 = self.b1 - lr * grad_b1","targetRectangle":{"y":655.69989928228142,"x":499.67270336794468,"width":337.1484375,"height":19}},{"text":"        self.w2 = self.w2 - lr * grad_w2","targetRectangle":{"y":674.69989928228142,"x":499.67270336794468,"width":337.1484375,"height":19}},{"text":"        self.b2 = self.b2 - lr * grad_b2","targetRectangle":{"y":693.69989928228142,"x":499.67270336794468,"width":337.1484375,"height":19}},{"text":"class MLP():","targetRectangle":{"y":24.824270368043869,"x":36.102128460469537,"width":101.14453125,"height":19}},{"text":"  def __init__(self, D_in, H, D_out):","targetRectangle":{"y":43.824270368043869,"x":36.102128460469537,"width":311.8623046875,"height":19}},{"text":"    self.w1, self.b1 = np.random.normal(loc=0.0,","targetRectangle":{"y":62.824270368043869,"x":36.102128460469537,"width":404.578125,"height":19}},{"text":"                                  scale=np.sqrt(2\/(D_in+H)),","targetRectangle":{"y":81.824270368043869,"x":36.102128460469537,"width":505.72265625,"height":19}},{"text":"                                  size=(D_in, H)), np.zeros(H)","targetRectangle":{"y":100.82427036804387,"x":36.102128460469537,"width":522.580078125,"height":19}},{"text":"    self.w2, self.b2 = np.random.normal(loc=0.0,","targetRectangle":{"y":119.82427036804387,"x":36.102128460469537,"width":404.578125,"height":19}},{"text":"                                  scale=np.sqrt(2\/(H+D_out)),","targetRectangle":{"y":138.82427036804387,"x":36.102128460469537,"width":514.1513671875,"height":19}},{"text":"                                  size=(H, D_out)), np.zeros(D_out)","targetRectangle":{"y":157.82427036804387,"x":36.102128460469537,"width":564.7236328125,"height":19}},{"text":"   ","targetRectangle":{"y":176.82427036804387,"x":36.102128460469537,"width":25.2861328125,"height":19}},{"text":"    self.loss = mse","targetRectangle":{"y":195.82427036804387,"x":36.102128460469537,"width":160.1455078125,"height":19}},{"text":"    self.grad_loss = grad_mse","targetRectangle":{"y":214.82427036804387,"x":36.102128460469537,"width":244.4326171875,"height":19}},{"text":"  def __call__(self, x):","targetRectangle":{"y":252.82427036804387,"x":36.102128460469537,"width":202.2890625,"height":19}},{"text":"    self.h = np.dot(x, self.w1) + self.b1","targetRectangle":{"y":271.82427036804387,"x":36.102128460469537,"width":345.5771484375,"height":19}},{"text":"    y_hat = np.dot(self.h, self.w2)  + self.b2","targetRectangle":{"y":290.82427036804387,"x":36.102128460469537,"width":387.720703125,"height":19}},{"text":"    return self.final_activation(y_hat)","targetRectangle":{"y":309.82427036804387,"x":36.102128460469537,"width":328.7197265625,"height":19}},{"text":"  def final_activation(self, x):","targetRectangle":{"y":347.82427036804387,"x":36.102128460469537,"width":269.71875,"height":19}},{"text":"    return x","targetRectangle":{"y":366.82427036804387,"x":36.102128460469537,"width":101.14453125,"height":19}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00049229876906403734,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A977EEAD22A0E889A4E656D0ACC3EF31"}]}]}}]}