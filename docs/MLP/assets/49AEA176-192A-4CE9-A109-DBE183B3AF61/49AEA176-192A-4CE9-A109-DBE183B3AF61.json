{"assets":{"A7D74C5963F5EA0737608FD36C1B2E43":{"type":"texture","index":0,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/49AEA176-192A-4CE9-A109-DBE183B3AF61.pdf"},"width":1024,"height":768},"30141EF4310B573E440999D72DB119D2":{"type":"texture","index":1,"assetRequest":{"type":"slide","state":"contents","slide":"none"},"url":{"native":"assets\/49AEA176-192A-4CE9-A109-DBE183B3AF61.pdf"},"width":1024,"height":768}},"events":[{"effects":[{"beginTime":0,"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00049229876906403734,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"30141EF4310B573E440999D72DB119D2"},{"animations":[{"timeOffset":0,"from":{"scalar":false},"beginTime":0,"repeatCount":0,"fillMode":"both","property":"hidden","autoreverses":false,"duration":0.01,"to":{"scalar":true}}],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A7D74C5963F5EA0737608FD36C1B2E43"}]}]},"effects":[],"duration":0.01,"type":"transition","attributes":{"direction":0},"name":"none","objectID":"0"}],"automaticPlay":false,"hyperlinks":[],"accessibility":[{"text":"class MLP():","targetRectangle":{"y":24.82426643371582,"x":36.102127075195312,"width":101.14453125,"height":19}},{"text":"  def __init__(self, D_in, H, D_out):","targetRectangle":{"y":43.82426643371582,"x":36.102127075195312,"width":311.8623046875,"height":19}},{"text":"    self.w1, self.b1 = np.random.normal(loc=0.0,","targetRectangle":{"y":62.82426643371582,"x":36.102127075195312,"width":404.578125,"height":19}},{"text":"                                  scale=np.sqrt(2\/(D_in+H)),","targetRectangle":{"y":81.82426643371582,"x":36.102127075195312,"width":505.72265625,"height":19}},{"text":"                                  size=(D_in, H)), np.zeros(H)","targetRectangle":{"y":100.82426643371582,"x":36.102127075195312,"width":522.580078125,"height":19}},{"text":"    self.w2, self.b2 = np.random.normal(loc=0.0,","targetRectangle":{"y":119.82426643371582,"x":36.102127075195312,"width":404.578125,"height":19}},{"text":"                                  scale=np.sqrt(2\/(H+D_out)),","targetRectangle":{"y":138.82426643371582,"x":36.102127075195312,"width":514.1513671875,"height":19}},{"text":"                                  size=(H, D_out)), np.zeros(D_out)","targetRectangle":{"y":157.82426643371582,"x":36.102127075195312,"width":564.7236328125,"height":19}},{"text":"   ","targetRectangle":{"y":176.82426643371582,"x":36.102127075195312,"width":25.2861328125,"height":19}},{"text":"    self.loss = mse","targetRectangle":{"y":195.82426643371582,"x":36.102127075195312,"width":160.1455078125,"height":19}},{"text":"    self.grad_loss = grad_mse","targetRectangle":{"y":214.82426643371582,"x":36.102127075195312,"width":244.4326171875,"height":19}},{"text":"  def __call__(self, x):","targetRectangle":{"y":252.82426643371582,"x":36.102127075195312,"width":202.2890625,"height":19}},{"text":"    self.h = np.dot(x, self.w1) + self.b1","targetRectangle":{"y":271.82426643371582,"x":36.102127075195312,"width":345.5771484375,"height":19}},{"text":"    y_hat = np.dot(self.h, self.w2)  + self.b2","targetRectangle":{"y":290.82426643371582,"x":36.102127075195312,"width":387.720703125,"height":19}},{"text":"    return self.final_activation(y_hat)","targetRectangle":{"y":309.82426643371582,"x":36.102127075195312,"width":328.7197265625,"height":19}},{"text":"  def final_activation(self, x):","targetRectangle":{"y":347.82426643371582,"x":36.102127075195312,"width":269.71875,"height":19}},{"text":"    return x","targetRectangle":{"y":366.82426643371582,"x":36.102127075195312,"width":101.14453125,"height":19}},{"text":"  def fit(self, X, Y, epochs = 100, lr = 0.001):","targetRectangle":{"y":254.12778345243009,"x":489.38418831411491,"width":404.578125,"height":19}},{"text":"    for e in range(epochs):    ","targetRectangle":{"y":273.12778345243009,"x":489.38418831411491,"width":261.2900390625,"height":19}},{"text":"     for x, y in zip(X, Y): ","targetRectangle":{"y":292.12778345243009,"x":489.38418831411491,"width":236.00390625,"height":19}},{"text":"        # add batch dimension","targetRectangle":{"y":311.12778345243009,"x":489.38418831411491,"width":244.4326171875,"height":19}},{"text":"        x = x[None,:]        ","targetRectangle":{"y":330.12778345243009,"x":489.38418831411491,"width":244.4326171875,"height":19}},{"text":"        y_pred = self(x) ","targetRectangle":{"y":349.12778345243009,"x":489.38418831411491,"width":210.7177734375,"height":19}},{"text":"        # loss function","targetRectangle":{"y":368.12778345243009,"x":489.38418831411491,"width":193.8603515625,"height":19}},{"text":"        loss = self.loss(y_pred, y).mean()","targetRectangle":{"y":387.12778345243009,"x":489.38418831411491,"width":354.005859375,"height":19}},{"text":"        # Backprop ","targetRectangle":{"y":406.12778345243009,"x":489.38418831411491,"width":160.1455078125,"height":19}},{"text":"        # dl\/dy","targetRectangle":{"y":425.12778345243009,"x":489.38418831411491,"width":126.4306640625,"height":19}},{"text":"        dldy = self.grad_loss(y_pred, y)        ","targetRectangle":{"y":444.12778345243009,"x":489.38418831411491,"width":404.578125,"height":19}},{"text":"        # dl\/dw2 = dl\/dy * dy\/dw2","targetRectangle":{"y":463.12778345243009,"x":489.38418831411491,"width":278.1474609375,"height":19}},{"text":"        grad_w2 = np.dot(self.h.T, dldy)","targetRectangle":{"y":482.12778345243009,"x":489.38418831411491,"width":337.1484375,"height":19}},{"text":"        grad_b2 = dldy","targetRectangle":{"y":501.12778345243009,"x":489.38418831411491,"width":185.431640625,"height":19}},{"text":"        # dl\/dh = dl\/dy * dy\/dh","targetRectangle":{"y":520.12778345243009,"x":489.38418831411491,"width":261.2900390625,"height":19}},{"text":"        dldh = np.dot(dldy, self.w2.T)      ","targetRectangle":{"y":539.12778345243009,"x":489.38418831411491,"width":370.86328125,"height":19}},{"text":"        # dl\/dw1 = dl\/dy * dy\/dh * dh\/dw1","targetRectangle":{"y":558.12778345243009,"x":489.38418831411491,"width":345.5771484375,"height":19}},{"text":"        grad_w1 = np.dot(x.T, dldh)","targetRectangle":{"y":577.12778345243009,"x":489.38418831411491,"width":295.0048828125,"height":19}},{"text":"        grad_b1 = dldh ","targetRectangle":{"y":596.12778345243009,"x":489.38418831411491,"width":193.8603515625,"height":19}},{"text":"        # Update (GD)","targetRectangle":{"y":615.12778345243009,"x":489.38418831411491,"width":177.0029296875,"height":19}},{"text":"        self.w1 = self.w1 - lr * grad_w1","targetRectangle":{"y":634.12778345243009,"x":489.38418831411491,"width":337.1484375,"height":19}},{"text":"        self.b1 = self.b1 - lr * grad_b1","targetRectangle":{"y":653.12778345243009,"x":489.38418831411491,"width":337.1484375,"height":19}},{"text":"        self.w2 = self.w2 - lr * grad_w2","targetRectangle":{"y":672.12778345243009,"x":489.38418831411491,"width":337.1484375,"height":19}},{"text":"        self.b2 = self.b2 - lr * grad_b2","targetRectangle":{"y":691.12778345243009,"x":489.38418831411491,"width":337.1484375,"height":19}},{"text":"def mse(output, target):","targetRectangle":{"y":37.093790076857488,"x":672.12811606703622,"width":202.2890625,"height":19}},{"text":"    return 0.5*(output - target)**2","targetRectangle":{"y":56.093790076857488,"x":672.12811606703622,"width":295.0048828125,"height":19}},{"text":"  ","targetRectangle":{"y":75.093790076857488,"x":672.12811606703622,"width":16.857421875,"height":19}},{"text":"def grad_mse(output, target):  ","targetRectangle":{"y":94.093790076857488,"x":672.12811606703622,"width":261.2900390625,"height":19}},{"text":"    return (output - target)","targetRectangle":{"y":113.09379007685749,"x":672.12811606703622,"width":236.00390625,"height":19}}],"baseLayer":{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"objectID":"0","layers":[{"animations":[],"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,-0.00049229876906403734,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":251658240,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"layers":[{"animations":[],"layers":[],"texturedRectangle":{"isBackgroundTexture":false,"singleTextureOpacity":1,"textureType":0,"textBaseline":0,"textXHeight":0,"isVerticalText":false},"initialState":{"affineTransform":[1,0,0,1,0,0],"masksToBounds":false,"rotation":0,"scale":1,"position":{"pointX":512,"pointY":384},"width":1024,"sublayerTransform":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"contentsRect":{"y":0,"x":0,"width":1,"height":1},"opacity":1,"edgeAntialiasingMask":0,"height":768,"hidden":false,"anchorPoint":{"pointX":0.5,"pointY":0.5}},"texture":"A7D74C5963F5EA0737608FD36C1B2E43"}]}]}}]}